<script>
  const scriptURL = "https://script.google.com/macros/s/AKfycbzq2i8CTcZA1wGG7JlTUQaDmWt6vlIqIRP4stdMdd-fv9ZRILV9aNAY-8m-VYouxXIY/exec";
  const form = document.getElementById("projectForm");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const project = {
      name: form.elements["name"].value,
      start: form.elements["start"].value,
      end: form.elements["end"].value,
      owner: form.elements["owner"].value,
      status: form.elements["status"].value,
      budget: form.elements["budget"].value,
      description: form.elements["description"].value
    };

    try {
      const response = await fetch(scriptURL, {
        method: "POST",
        mode: "no-cors", // Ensures Vercel-to-Google compatibility
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ project: project })
      });

      alert("✅ Project submitted. Check Google Sheet.");
      form.reset();
    } catch (err) {
      alert("❌ Error submitting project: " + err.message);
    }
  });
</script>
